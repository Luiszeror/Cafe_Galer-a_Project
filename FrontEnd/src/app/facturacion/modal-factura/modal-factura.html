<div class="modal-container">
  <div class="modal-header">
    <h2>Mesa {{ data.mesa }}</h2>
    <button class="close-btn" (click)="cerrar()">‚úï</button>
  </div>

  <div class="tabla-productos">
    <table>
      <thead>
        <tr>
          <th>Producto</th>
          <th>Tipo</th>
          <th>Cantidad</th>
          <th>Precio Unit.</th>
          <th>Subtotal</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let producto of productosFactura">
          <td>
            <strong>{{ producto.name }}</strong>
            <small *ngIf="producto.description" style="display: block; color: #666; font-size: 12px;">
              {{ producto.description }}
            </small>
          </td>
          <td>
            <span class="badge" [class.badge-ceramica]="producto.tipo === 'Cer√°micas'" 
                  [class.badge-cafeteria]="producto.tipo === 'Cafeter√≠a'">
              {{ producto.tipo }}
            </span>
          </td>
          <td>
            <div class="cantidad-control">
              <button class="btn-qty" (click)="modificarCantidad(producto, producto.cantidad - 1)">-</button>
              <span class="qty-value">{{ producto.cantidad }}</span>
              <button class="btn-qty" (click)="modificarCantidad(producto, producto.cantidad + 1)">+</button>
            </div>
          </td>
          <td>{{ producto.price | currency:'USD':'symbol':'1.0-0' }}</td>
          <td><strong>{{ calcularSubtotal(producto) | currency:'USD':'symbol':'1.0-0' }}</strong></td>
          <td>
            <button class="btn-eliminar" (click)="eliminarProducto(producto)" title="Eliminar">
              üóëÔ∏è
            </button>
          </td>
        </tr>
        <tr *ngIf="productosFactura.length === 0">
          <td colspan="6" style="text-align: center; color: #999; padding: 30px;">
            No hay productos en la factura. Haz clic en "A√±adir producto" para comenzar.
          </td>
        </tr>
      </tbody>
      <tfoot *ngIf="productosFactura.length > 0">
        <tr>
          <td colspan="4" style="text-align: right; font-weight: bold;">Total:</td>
          <td style="font-weight: bold; font-size: 1.2em; color: #667eea;">
            {{ calcularTotal() | currency:'USD':'symbol':'1.0-0' }}
          </td>
          <td></td>
        </tr>
      </tfoot>
    </table>
  </div>

  <div class="acciones">
    <button class="cancelar" (click)="cancelar()">Cancelar</button>
    <button class="anadir" (click)="anadirProducto()">
      <span>‚ûï</span> A√±adir producto
    </button>
    <button class="pagar" (click)="pagar()" [disabled]="productosFactura.length === 0">
      <span>üí∞</span> Pagar
    </button>
  </div>

  <!-- SUBMODAL DE SELECCI√ìN -->
  <div class="submodal-backdrop" *ngIf="mostrarSeleccion" (click)="cerrarSeleccion()">
    <div class="submodal" (click)="$event.stopPropagation()">
      <h3>Seleccionar tipo de producto</h3>
      <div class="opciones">
        <button class="opcion-btn ceramicas" (click)="seleccionarProducto('Cer√°micas')">
          <span class="icon">üè∫</span>
          <span class="texto">Cer√°micas</span>
        </button>
        <button class="opcion-btn cafeteria" (click)="seleccionarProducto('Cafeter√≠a')">
          <span class="icon">‚òï</span>
          <span class="texto">Cafeter√≠a</span>
        </button>
      </div>
      <button class="cerrar-sub" (click)="cerrarSeleccion()">Cerrar</button>
    </div>
  </div>
</div>