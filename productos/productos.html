<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<div class="contenido">
  <div class="head">
    <h1>Productos</h1>
    <div class="header-right">
      <button mat-icon-button color="primary" (click)="abrirAgregar()" matTooltip="Agregar Producto" class="agregar-btn">
        <mat-icon>add_circle</mat-icon>
      </button>
    </div>
  </div>

  <div class="table-container">
    <table mat-table [dataSource]="productos" class="mat-elevation-z2 modern-table">

      <!-- Nombre -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Nombre</th>
        <td mat-cell *matCellDef="let producto">{{ producto.name }}</td>
      </ng-container>

      <!-- Precio -->
      <ng-container matColumnDef="price">
        <th mat-header-cell *matHeaderCellDef>Precio</th>
        <td mat-cell *matCellDef="let producto">{{ producto.price | currency:'USD':'symbol' }}</td>
      </ng-container>

      <!-- Descripción -->
      <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef>Descripción</th>
        <td mat-cell *matCellDef="let producto">{{ producto.description }}</td>
      </ng-container>

      <!-- Activo -->
      <ng-container matColumnDef="active">
        <th mat-header-cell *matHeaderCellDef>Activo</th>
        <td mat-cell *matCellDef="let producto">
          <mat-icon class="activo-icon" [ngClass]="{'activo': producto.active, 'inactivo': !producto.active}">
            {{ producto.active ? 'check_circle' : 'highlight_off' }}
          </mat-icon>
        </td>
      </ng-container>

      <!-- Acciones -->
      <ng-container matColumnDef="acciones">
        <th mat-header-cell *matHeaderCellDef>Acciones</th>
        <td mat-cell *matCellDef="let producto">
          <button mat-icon-button color="primary" (click)="abrirEditar(producto)" matTooltip="Editar">
            <mat-icon>edit</mat-icon>
          </button>
          <button mat-icon-button color="warn" (click)="eliminarProducto(producto)" matTooltip="Eliminar">
            <mat-icon>delete</mat-icon>
          </button>
          <button mat-icon-button color="accent" (click)="toggleActivo(producto)" matTooltip="Activar/Inactivar">
            <mat-icon>{{ producto.active ? 'toggle_on' : 'toggle_off' }}</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="['name','price','description','active','acciones']"></tr>
      <tr mat-row *matRowDef="let row; columns: ['name','price','description','active','acciones'];"></tr>
    </table>
  </div>


  <!-- Modal -->
  <div class="modal-fondo" *ngIf="mostrarModal">
    <div class="modal">
      <h2>{{ modoEdicion ? 'Editar Producto' : 'Agregar Producto' }}</h2>
      <form [formGroup]="productoForm">
        <mat-form-field class="full-width">
          <mat-label>Nombre</mat-label>
          <input matInput formControlName="name" placeholder="Nombre del producto">
        </mat-form-field>

        <mat-form-field class="full-width">
          <mat-label>Precio</mat-label>
          <input matInput type="number" formControlName="price" placeholder="Precio">
        </mat-form-field>

        <mat-form-field class="full-width">
          <mat-label>Descripción</mat-label>
          <input matInput formControlName="description" placeholder="Descripción">
        </mat-form-field>

        <mat-form-field class="full-width">
          <mat-label>Activo</mat-label>
          <select matNativeControl formControlName="active">
            <option [value]="true">Sí</option>
            <option [value]="false">No</option>
          </select>
        </mat-form-field>

        <div class="modal-footer">
          <button mat-raised-button color="primary" (click)="guardarProducto()">Guardar</button>
          <button mat-raised-button color="warn" (click)="cerrarModal()">Cancelar</button>
        </div>
      </form>
    </div>
  </div>
</div>
